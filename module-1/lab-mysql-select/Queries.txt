USE lab_mysql_select;

SELECT au.au_id AS AUTHOR_ID, au.au_lname AS LAST_NAME, au.au_fname AS FIRST_NAME, t.title AS TITLE, p.pub_name AS PUBLISHER
FROM authors AS au
JOIN titleauthor AS ta
ON au.au_id= ta.au_id
JOIN titles AS t
ON ta.title_id = t.title_id
JOIN publishers AS p
ON t.pub_id= p.pub_id;

SELECT au.au_id AS AUTHOR_ID, au.au_lname AS LAST_NAME, 
au.au_fname AS FIRST_NAME, p.pub_name AS PUBLISHER, count(t.title_id) AS TITLE_COUNT
FROM authors AS au
JOIN titleauthor AS ta
ON au.au_id= ta.au_id
JOIN titles AS t
ON ta.title_id = t.title_id
JOIN publishers AS p
ON t.pub_id= p.pub_id
GROUP BY au.au_id, p.pub_id
ORDER BY TITLE_COUNT desc

SELECT au.au_id AS AUTHOR_ID, au.au_lname AS LAST_NAME, 
au.au_fname AS FIRST_NAME, sum(s.qty) AS TOTAL
FROM authors AS au
JOIN titleauthor AS ta
ON au.au_id= ta.au_id
JOIN titles AS t
ON ta.title_id = t.title_id
JOIN sales AS s
ON t.title_id= s.title_id
GROUP BY au.au_id
ORDER BY TOTAL DESC
LIMIT 0, 3

SELECT au.au_id AS AUTHOR_ID, au.au_lname AS LAST_NAME, 
au.au_fname AS FIRST_NAME, sum(s.qty) AS TOTAL
FROM authors AS au
JOIN titleauthor AS ta
ON au.au_id= ta.au_id
JOIN titles AS t
ON ta.title_id = t.title_id
JOIN sales AS s
ON t.title_id= s.title_id
GROUP BY au.au_id
ORDER BY TOTAL DESC
LIMIT 0, 23

